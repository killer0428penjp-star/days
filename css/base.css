/* =========================================
   Base & Theme Variables
========================================= */
:root {
  --main-bg: #f0f4f8; 
  --card-bg: rgba(255, 255, 255, 0.8); 
  --accent: #0070ff;
  --text-main: #1a202c; 
  --text-sub: #718096; 
  --border-soft: #e2e8f0;
  --up-color: #ff4d4d; 
  --down-color: #0070ff;
  --cal-bg: #ffffff; 
  --cal-text: #1a202c; 
  --cal-cell-bg: #f8fafc; 
  --cal-memo-bg: #ffffff;
  --primary: #2d3436; 
  --danger: #ff7675; 
  --success: #00b894; 
  --bg: #f8f9fa; 
  --card: #ffffff;
}

body.dark-mode {
  --main-bg: #1e1e2f; 
  --card-bg: rgba(30, 30, 47, 0.85); 
  --accent: #00f2ff;
  --text-main: #ffffff; 
  --text-sub: #a0aec0; 
  --border-soft: #2d3748;
  --down-color: #00f2ff; 
  --cal-bg: #111111; 
  --cal-text: #ffffff; 
  --cal-cell-bg: #222222; 
  --cal-memo-bg: #1a1a1a;
}

/* =========================================
   Global Styles
========================================= */
body { 
  margin: 0; 
  font-family: 'Montserrat', sans-serif; 
  background-color: var(--main-bg); 
  background-image: radial-gradient(var(--border-soft) 1px, transparent 1px); 
  background-size: 20px 20px; 
  color: var(--text-main); 
  transition: 0.4s; 
  overflow-x: hidden; 
}

.hidden { display: none !important; }
.mono { font-family: 'JetBrains Mono', monospace; }
input::-webkit-inner-spin-button { -webkit-appearance: none; }
.no-scrollbar::-webkit-scrollbar { display: none; }

/* =========================================
   Top Header & Switches
========================================= */
.switch-container { position: fixed; top: 15px; left: 14px; z-index: 1000; }
.switch { position: relative; width: 44px; height: 24px; display: block; cursor: pointer; }
.switch input { opacity: 0; }
.slider { position: absolute; inset: 0; background: #ccc; border-radius: 30px; transition: 0.4s; }
.slider::before { content: ""; position: absolute; width: 18px; height: 18px; left: 3px; bottom: 3px; background: white; border-radius: 50%; transition: 0.4s; }
input:checked + .slider { background: var(--accent); }
input:checked + .slider::before { transform: translateX(20px); }

#date-top {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 8px;
  font-size: 14px;
  font-weight: 700;
  color: var(--text-main);
  margin-top: 15px;
  margin-bottom: 5px;
  letter-spacing: 0.05em;
}

/* HTML側で既に()がついているため、CSSでの擬似要素()追加は削除しました */

body.dark-mode #date-top {
  text-shadow: 0 0 8px rgba(0, 242, 255, 0.3);
}

.weather-top {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 15px;
  font-size: 14px;
  color: var(--text-sub);
  margin-bottom: 5px;
}

/* =========================================
   Animations
========================================= */
@keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
@keyframes blink { 0% { opacity: 1; } 50% { opacity: 0.4; } 100% { opacity: 1; } }
.blink { animation: blink 1s infinite; }

@keyframes wave-anim { from { transform: translateX(0) rotate(0deg); } to { transform: translateX(-50%) rotate(360deg); } }
@keyframes leaf-sway { 0%, 100% { transform: translateY(0) rotate(0deg); } 50% { transform: translateY(-20px) rotate(20deg); } }

/* =========================================
   Study Screen Specifics
========================================= */
#study-screen {
  /* study画面内だけの変数として定義し、他の画面の--accentと競合しないように変更 */
  --study-accent: #2563eb; 
  --study-break: #10b981;
  
  position: relative; /* 背景アニメーションが他のタブへはみ出さないように追加 */
  overflow: hidden;   /* 同上 */
  
  font-family: 'Plus Jakarta Sans', sans-serif; 
  color: #1e293b; 
  transition: all 0.5s ease; 
}

#bg-container { 
  position: absolute; /* fixedから変更（他の画面への干渉防止） */
  inset: 0; 
  z-index: -1; 
  background: transparent; 
  background-size: cover; 
  background-position: center; 
}

#anim-layer { 
  position: absolute; 
  inset: 0; 
  pointer-events: none; 
}

.waves-bg { background: linear-gradient(180deg, #fff 0%, #e0f2fe 100%); }
.wave-obj { position: absolute; bottom: 0; width: 200%; height: 15vh; background: rgba(37, 99, 235, 0.05); border-radius: 40%; animation: wave-anim 15s linear infinite; }

.trees-bg { background: linear-gradient(180deg, #fff 0%, #f0fdf4 100%); }
.leaf-obj { position: absolute; background: #22c55e; border-radius: 50% 0 50% 0; opacity: 0.08; animation: leaf-sway 6s ease-in-out infinite; }

.clock-face { width: 260px; height: 260px; border-radius: 50%; border: 1px solid rgba(0,0,0,0.05); background: rgba(255,255,255,0.8); backdrop-filter: blur(10px); position: relative; }
.hand { position: absolute; bottom: 50%; left: 50%; transform-origin: bottom center; border-radius: 10px; z-index: 10; will-change: transform; }
.main-hand { width: 4px; height: 110px; background: var(--study-accent); margin-left: -2px; }
.numeral { position: absolute; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; font-weight: 800; color: #cbd5e1; margin-top: -15px; margin-left: -15px; }

.glass { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.5); }
.tab-active { color: var(--study-accent); border-bottom: 2px solid var(--study-accent); }

/* Analytics Charts */
.chart-bar { transition: height 0.6s cubic-bezier(0.34, 1.56, 0.64, 1); border-radius: 4px; min-height: 4px; }
.timeline-block { position: absolute; height: 100%; top: 0; opacity: 0.9; border-radius: 2px; min-width: 2px; transition: all 0.3s ease; z-index: 10; cursor: pointer; }
.timeline-block:hover { z-index: 30; transform: scaleY(1.2); opacity: 1; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }